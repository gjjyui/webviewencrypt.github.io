//>>built
require({cache:{"webview/widget/passwords/_ResetPasswordMixin":function(){define("dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/_base/lang dojo/Deferred dojo/i18n!../../nls/all dojo/i18n!../../nls/errorMessages dojo/i18n!../../nls/resetPassword dojo/json dojo/on dojo/request/xhr dojo/topic dojox/html/entities rc/util/notices".split(" "),function(c,h,k,d,b,e,f,g,a,q,r,t,u,l,n){return d("webview/widget/passwords/_ResetPasswordMixin",[],{resetPasswordStrings:a,
webviewStrings:f,webviewUtils:null,_ErrorMap:{501:a.incorrectPassword,502:a.passwordMustChange,503:a.passwordsDoNotMatch,508:g.unexpectedError,520:a.loginMustNotMatchApproval,521:a.approvalMustNotMatchLogin},_IncorrectLoginCode:501,_invalidLoginPassword:null,_invalidNewPassword:null,_LockedOutCode:507,_LockedOutRequiresAdminCode:509,_LoginMatchesApproval:504,_SuccessCode:200,_UnexpectedCode:508,buildRendering:function(){this.inherited(arguments);this._setTitle()},postCreate:function(){this.inherited(arguments);
this._setupValidators();this.own(r(this.resetForm,"submit",b.hitch(this,this._onSubmit)));this.webviewUtils=rc.singletonUtil},_displayErrorMessage:function(a){n.widget.clear();var p=this._ErrorMap[this._UnexpectedCode];"undefined"!==typeof this._ErrorMap[a.errStatus]&&(p=this._ErrorMap[a.errStatus]);a.errStatus===this._UnexpectedCode?console.error(this.declaredClass+" - _displayErrorMessage()",a.errMsg):a.errStatus===this._IncorrectLoginCode?this._invalidLoginPassword=this.loginPassword.get("value"):
a.errStatus===this._LoginMatchesApproval&&(this._invalidNewPassword=this.newPassword.get("value"));u.publish("sticky",{type:"error",message:p});this.resetForm.validate()},_encryptPasswords:function(a){var m=new e;this.own(m);this.webviewUtils.getRSAKeys().then(b.hitch(this,function(b){a.loginPassword=this.webviewUtils.encrypt(l.encode(a.loginPassword),b);a.newPassword=this.webviewUtils.encrypt(l.encode(a.newPassword),b);a.confirmationPassword=this.webviewUtils.encrypt(l.encode(a.confirmationPassword),
b);m.resolve(a)}));return m.promise},_onSubmit:function(){this._trimPasswords();var a=this.resetForm.get("value");this.isADGroupUser&&(a.username=sessionStorage.getItem("un"));this.resetForm.validate()&&this._encryptPasswords(a).then(b.hitch(this,this._sendToServer));return!1},_redirect:function(){this.redirectPath=rc.session.getRedirect();window.location=this.redirectPath},_redirectLogin:function(){window.location=rc.loginURI},_sendToServer:function(a){n.widget.clear();t.post(!0===this.isADGroupUser?
"UpdateForADGroupUser":"Update",{handleAs:"json",data:a}).then(b.hitch(this,function(a){a.errStatus===this._SuccessCode?(a={data:q.stringify(a.data)},rc.session._passwordChecked(a).then(b.hitch(this,this._redirect))):a.errStatus===this._LockedOutCode||a.errStatus===this._LockedOutRequiresAdminCode?this._redirectLogin():this._displayErrorMessage(a)}),b.hitch(this,this._displayErrorMessage,{errStatus:this._UnexpectedCode,errMsg:"Rejected"}))},_setupValidators:function(){this.confirmationPassword.set("validator",
b.hitch(this,this._validateConfirmationPassword));this.loginPassword.set("validator",b.hitch(this,this._validateLoginPassword));this.newPassword.set("validator",b.hitch(this,this._validateNewPassword))},_trimPasswords:function(){""===this.newPassword.get("value").trim()&&this.newPassword.set("value","");""===this.confirmationPassword.get("value").trim()&&this.confirmationPassword.set("value","")},_validateConfirmationPassword:function(a){return a===this.newPassword.get("value")},_validateNewPassword:function(a){throw"_validateNewPassword must be implemented by the parent";
},_validateLoginPassword:function(a){var b=!0;""===a?b=!1:null!==this._invalidLoginPassword&&(this._invalidLoginPassword===a?b=!1:null==this._invalidLoginPassword);return b}})})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(c,h,k,d,b,e,f,g){return c("dijit.form.Form",[b,e,f,g],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",
templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(a){h.set(this.domNode,"encType",a);d("ie")&&(this.domNode.encoding=a);this._set("encType",a)},reset:function(a){var b={returnValue:!0,preventDefault:function(){this.returnValue=
!1},stopPropagation:function(){},currentTarget:a?a.target:this.domNode,target:a?a.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(a){this.reset(a);a.stopPropagation();a.preventDefault();return!1},_onSubmit:function(a){var b=this.constructor.prototype;if(this.execute!=b.execute||this.onExecute!=b.onExecute)k.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),
this.execute(this.getValues());!1===this.onSubmit(a)&&(a.stopPropagation(),a.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"url:webview/widget/passwords/templates/ResetPassword.html":'\x3cdiv class\x3d"mpwLoginForm reset-password-form"\x3e\r\n    \x3cform method\x3d"post" action\x3d"" encType\x3d"multipart/form-data"\r\n          data-dojo-attach-point\x3d"resetForm"\r\n          data-dojo-type\x3d"dijit/form/Form"\x3e\r\n        \x3cdiv class\x3d"formRow"\x3e\r\n            \x3cp\x3e${templateContentStrings.pageTitle}\x3c/p\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"formRow"\x3e\r\n            \x3clabel class\x3d"leadlabel" for\x3d"loginPassword"\x3e${webviewStrings.currPass}:\x3c/label\x3e\r\n            \x3cinput type\x3d"password" id\x3d"loginPassword" name\x3d"loginPassword"\r\n                   data-dojo-attach-point\x3d"loginPassword"\r\n                   data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n                   data-dojo-props\x3d\'required: true, baseClass: "rcTextBox",\r\n                   invalidMessage: "${resetPasswordStrings.incorrectPassword}",\r\n                   missingMessage: "${resetPasswordStrings.loginPasswordRequired}"\' /\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"formRow"\x3e\r\n            \x3clabel class\x3d"leadlabel" for\x3d"newPassword"\x3e${templateContentStrings.newPasswordLabel}:\x3c/label\x3e\r\n            \x3cinput type\x3d"password" id\x3d"newPassword" name\x3d"newPassword"\r\n                   data-dojo-attach-point\x3d"newPassword"\r\n                   data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n                   data-dojo-props\x3d\'required: true, baseClass: "rcTextBox",\r\n                   invalidMessage: "${templateContentStrings.newPasswordInvalidMessage}",\r\n                   missingMessage: "${resetPasswordStrings.newPasswordRequired}"\' /\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"formRow"\x3e\r\n            \x3clabel class\x3d"leadlabel" for\x3d"confirmationPassword"\x3e${resetPasswordStrings.confirmPassword}:\x3c/label\x3e\r\n            \x3cinput type\x3d"password" id\x3d"confirmationPassword" name\x3d"confirmationPassword"\r\n                   data-dojo-attach-point\x3d"confirmationPassword"\r\n                   data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n                   data-dojo-props\x3d\'required: true, baseClass: "rcTextBox",\r\n                   invalidMessage: "${resetPasswordStrings.passwordsDoNotMatch}",\r\n                   missingMessage: "${resetPasswordStrings.confirmPasswordRequired}"\' /\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cinput type\x3d"hidden" name\x3d"userId" value\x3d"${userId}" data-dojo-type\x3d"dijit/form/TextBox"/\x3e\r\n\r\n        \x3cp class\x3d"buttonCenter"\x3e\r\n            \x3cbutton class\x3d"logonButton"\r\n                    data-dojo-type\x3d"dijit/form/Button" name\x3d"submit" type\x3d"submit"\r\n                    data-dojo-props\x3d"baseClass: \'webviewButton\', iconClass: \'rcIcon okIcon\'"\x3e${webviewStrings.okay}\x3c/button\x3e\r\n        \x3c/p\x3e\r\n    \x3c/form\x3e\r\n\x3c/div\x3e',
"*now":function(c){c(['dojo/i18n!*preload*webview/widget/passwords/nls/ResetPassword*["en-gb","en-us","de","es","es-es","fr","fr-ca","pt","zh","zh-tw","ROOT"]'])}}});
define("webview/widget/passwords/ResetPassword","dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/dom-attr dojo/i18n!../../nls/resetPassword dojo/text!./templates/ResetPassword.html ./_ResetPasswordMixin dijit/form/Button dijit/form/Form dijit/form/TextBox dijit/form/ValidationTextBox".split(" "),function(c,h,k,d,b,e,f,g){return d("webview/widget/passwords/ResetPassword",[h,c,k,g],{resetPasswordStrings:e,templateString:f,templateContentStrings:null,constructor:function(){this.templateContentStrings=
{pageTitle:this.resetPasswordStrings.updateYourPassword,newPasswordLabel:this.resetPasswordStrings.newLoginPassword,newPasswordInvalidMessage:this.resetPasswordStrings.loginMustNotMatchApproval}},_setTitle:function(){document.title=this.resetPasswordStrings.updateYourPassword;b.set("version","innerHTML",webview.version.toString().toString())},_validateNewPassword:function(a){var b=!0;""===a?b=!1:null!==this._invalidNewPassword&&(this._invalidNewPassword===a?b=!1:null==this._invalidNewPassword);return b}})});
//# sourceMappingURL=ResetPassword.js.map